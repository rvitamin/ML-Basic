# Проект по предсказанию пульса

Исходный датасет представляет собой данные по беговым тренировкам. Он содержит
  - Время тренировки
  - Расстояние за тренировку
  - Фактический пульс

Идея заключается в том, то имея исторические данные по тренировкам, можно для будущих тренировок прогнозировать
средний пульс на этой тренировке.

### 10 Training Linerregression - базовая линейная регрессия
- Загрузил датасет
- Обучил линейную регрессию
- Результаты не удовлетворительные `RMSE = 5,9` (ударов в минуту)

_Далее попробовал обогатить датасет различными данными_

### 11 Training Linerregression extended dataset - линейная регрессия на расширенном датасете
- Добавил в датасет новые признаки с расчётными значениями:
   - Количество дней, прошедшее с предыдущей тренировки
   - Агрегаты по историческим беговым объёмам (за неделю, за месяц, за квартал, за год)
   - Агрегаты по историческому количеству тренировок (за неделю, за месяц, за квартал, за год)
- Добавил в датасет новые признаки из других источников:
   - Температуру воздуха в день тренировки в месте тренировки - нашёл датасеты в открытых источниках
   - Агрегаты по историческому количеству шагов (за неделю, за месяц, за квартал, за год)
   - Агрегаты по среднему пульсу в покое (за неделю, за месяц, за квартал, за год)
- На расширенном датасете получились значительно лучшие результаты - `RMSE = 4,3`

_Далее попробовал оптимизировать датасет_

### 12 Training Linerregression optim dataset - линейная регрессия на оптимизированном датасете
- Оценил какие признаки наиболее значимые и отбросил из датасета не значимые признаки
- Убрал строки для которых нет возможности собрать агрегаты по историческим данным
- Проверил корреляцию признаков, попробовал сделать ещё один датасет, убрав один из двух сильно скоррелированных параметра
- Метрика качества практически не изменилась - `RMSE = 4,5`

### 13 Training Bagging Linerregression - линейная регрессия с бэггингом
- Метрика качества без изменений - `RMSE = 4,4`

_Далее попробовал на оптимизированном датасете обучить различные модели с подбором параметров с помощью GridSearchCV_

### 14 Training KNN Grid
- Лучшие гиперпараметры {'n_neighbors': 10, 'weights': 'distance'}
- Метрика качества немного улучшилась  - `RMSE = 3,9`

### 15 Training RandomForest Grid
- Лучшие гиперпараметры {'max_depth': 30, 'n_estimators': 200}
- Метрика качества ещё больше улучшилась  - `RMSE = 3,2`

_Далее попробовал различные варианты градиентного бустинга с подбором параметров с помощью GridSearchCV_

### 16 Training GradientBoosting Grid
- Лучшие гиперпараметры {'max_depth': 5, 'n_estimators': 50}
- Метрика качества не стала лучше  - `RMSE = 3,4`

### 17 Training Catboost Grid
- Лучшие гиперпараметры {'max_depth': 5, 'n_estimators': 50}
- Метрика качества тоже не стала лучше  - `RMSE = 3,9`

### 18 Training LGBMRegressor Grid
- Лучшие гиперпараметры {'max_depth': 6, 'n_estimators': 73}
- Метрика качества стала лучше  - `RMSE = 3,1` - это лучший результат

_Далее попробовал голосующие модели с применением лучших моделей с лучшими параметрами_

- ### 19 Training VotingRegressor
- Лучшие гиперпараметры {'max_depth': 6, 'n_estimators': 73}
- Метрика качества НЕ стала лучше чем у лучшей модели - `RMSE = 3,4`